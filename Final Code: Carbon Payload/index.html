<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customized Circle Packing</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <style>
        body {
            background-color: #05141B; //same as Figma mockup 
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            position: relative; 
        }
        svg {
            font-family: sans-serif;
            cursor: pointer;
        }
        .title {
            position: absolute; 
            top: 10px; 
            left: 10px; 
            color: white; 
            z-index: 10; 
        }
    </style>
</head>
<body>
    <svg width="800" height="800"></svg>
    <div class="title">
        <h1>The Invisible CCs of an Email</h1>
    </div>
<script>
const data = {
            name: "CO2 Emissions",
            children: [
                {
                    name: "Sending Emails",
                    children: [
                        { name: "Recipients", children: [{ name: "0.3g per person", value: 0.3 }] },
                        { name: "Documents", children: [{ name: "20g per MB", value: 20 }] },
                        { name: "Audio", children: [{ name: "20g per MB", value: 20 }] },
                        { name: "Video", children: [{ name: "20g per MB", value: 20 }] },
                        { name: "Links", children: [{ name: "6g per link", value: 6 }] },
                        { name: "AI Prompts", children: [{ name: "4g per 100 words", value: 4 }] }
                    ]
                },
                {
                    name: "Receiving Emails",
                    children: [
                        { name: "Device", children: [
                            { name: "0.3g per mail on laptop", value: 0.3 },
                            { name: "0.2g per mail on phone", value: 0.2 }
                        ] },
                        { name: "Views", children: [{ name: "0.3g per view", value: 0.3 }] },
                        { name: "Subscriptions", children: [{ name: "30g per newsletter", value: 30 }] },
                        { name: "Spam", children: [{ name: "0.3g per email", value: 0.3 }] },
                        { name: "Saves", children: [{ name: "20g per MB", value: 20 }] }
                    ]
                }
            ]
        };
  const width = 800;
        const height = 800;

        const svg = d3.select("svg")
            .attr("viewBox", 0 0 ${width} ${height})
            .style("font", "10px sans-serif");

        const pack = d3.pack()
            .size([width, height])
            .padding(3);

        const root = d3.hierarchy(data)
            .sum(d => d.value || 0)
            .sort((a, b) => b.value - a.value);

        const nodes = pack(root).descendants();

        const circle = svg.selectAll("circle")
            .data(nodes)
            .join("circle")
            .attr("fill", d => {
                if (d.depth === 0) return "#10202D";
                if (d.depth === 1) return "#253745";
                if (d.depth === 2) return "#99A5A9";
                return "#ddd";
            })
            .attr("stroke", "none") // No border by default
            .attr("cx", d => d.x)
            .attr("cy", d => d.y)
            .attr("r", d => d.r)
            .on("mouseover", function (event, d) {
                d3.select(this).attr("stroke", "#FFC233").attr("stroke-width", 2);
                // Show corresponding text
                svg.selectAll("text")
                    .filter(t => t === d)
                    .style("opacity", 1);
            })
            .on("mouseout", function (event , d) {
                d3.select(this).attr("stroke", "none");
                // Hide corresponding text
                svg.selectAll("text")
                    .filter(t => t === d)
                    .style("opacity", 0);
            });

        const text = svg.selectAll("text")
            .data(nodes)
            .join("text")
            .attr("x", d => d.x)
            .attr("y", d => d.y)
            .attr("dy", "0.3em")
            .style("text-anchor", "middle")
            .style("font-size", "24px")
            .style("pointer-events", "none") // Prevent blocking hover
            .style("opacity", 0) // Hide text by default
            .style("fill", "10202D")
            .text(d => d.data.name);
</script>
</body>
</html>
